# ğŸ¨ Diagrama Visual: Proceso de ConfiguraciÃ³n del Webhook

## ğŸ“‹ Flujo Completo de ConfiguraciÃ³n

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROCESO DE CONFIGURACIÃ“N                      â”‚
â”‚                    DEL WEBHOOK DE TWILIO                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£  DESPLEGAR EN RAILWAY
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  https://railway.app/               â”‚
    â”‚  â†“                                   â”‚
    â”‚  New Project                         â”‚
    â”‚  â†“                                   â”‚
    â”‚  Connect GitHub Repo                 â”‚
    â”‚  â†“                                   â”‚
    â”‚  Deploy (wait for "Active" status)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                    â†“
2ï¸âƒ£  OBTENER URL DE RAILWAY
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Railway Dashboard                                   â”‚
    â”‚  â†“                                                   â”‚
    â”‚  Click en tu proyecto                                â”‚
    â”‚  â†“                                                   â”‚
    â”‚  Settings â†’ Domains                                  â”‚
    â”‚  â†“                                                   â”‚
    â”‚  [ Generate Domain ] â† Click si no existe            â”‚
    â”‚  â†“                                                   â”‚
    â”‚  ğŸ“‹ Copiar URL:                                      â”‚
    â”‚     agentewhatsapp-production.up.railway.app         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                    â†“
3ï¸âƒ£  CONSTRUIR URL DEL WEBHOOK
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  URL base de Railway:                                 â”‚
    â”‚  https://agentewhatsapp-production.up.railway.app     â”‚
    â”‚                                                       â”‚
    â”‚  +                                                    â”‚
    â”‚                                                       â”‚
    â”‚  /webhook/whatsapp                                    â”‚
    â”‚                                                       â”‚
    â”‚  =                                                    â”‚
    â”‚                                                       â”‚
    â”‚  âœ… URL COMPLETA DEL WEBHOOK:                         â”‚
    â”‚  https://agentewhatsapp-production.up.railway.app/... â”‚
    â”‚     .../webhook/whatsapp                              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                    â†“
4ï¸âƒ£  CONFIGURAR EN TWILIO
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  https://console.twilio.com/                          â”‚
    â”‚  â†“                                                    â”‚
    â”‚  Messaging â†’ Try it out â†’ Send WhatsApp message       â”‚
    â”‚  â†“                                                    â”‚
    â”‚  Sandbox Configuration                                â”‚
    â”‚  â†“                                                    â”‚
    â”‚  "When a message comes in":                           â”‚
    â”‚  [https://agentewhatsapp-...webhook/whatsapp    ]     â”‚
    â”‚                                                       â”‚
    â”‚  Method: [POST â–¼]                                     â”‚
    â”‚  â†“                                                    â”‚
    â”‚  [ Save ]                                             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                    â†“
5ï¸âƒ£  VERIFICAR CONFIGURACIÃ“N
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  âœ… Abrir en navegador:                               â”‚
    â”‚     https://agentewhatsapp-production.up.railway.app  â”‚
    â”‚                                                       â”‚
    â”‚  âœ… Debe mostrar:                                     â”‚
    â”‚     "Servidor WhatsApp activo"                        â”‚
    â”‚                                                       â”‚
    â”‚  âœ… Revisar logs en Railway:                          â”‚
    â”‚     ğŸ“± URL del Webhook para Twilio:                   â”‚
    â”‚        https://[tu-url]/webhook/whatsapp              â”‚
    â”‚                                                       â”‚
    â”‚  âœ… Enviar mensaje de prueba desde WhatsApp           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
                    â†“
        ğŸ‰ Â¡CONFIGURACIÃ“N COMPLETA! ğŸ‰
```

---

## ğŸ—ºï¸ Mapa Mental: Â¿De DÃ³nde Viene la URL?

```
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ Â¿De dÃ³nde viene  â”‚
                      â”‚   la URL del     â”‚
                      â”‚    webhook?      â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                             â”‚
                â–¼                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   RAILWAY     â”‚            â”‚  DESARROLLO   â”‚
        â”‚  (ProducciÃ³n) â”‚            â”‚    LOCAL      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                             â”‚
                â–¼                             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Railway genera      â”‚      â”‚ Usar ngrok o        â”‚
    â”‚ automÃ¡ticamente     â”‚      â”‚ localtunnel         â”‚
    â”‚                     â”‚      â”‚                     â”‚
    â”‚ Formato:            â”‚      â”‚ Ejemplo:            â”‚
    â”‚ [proyecto].         â”‚      â”‚ https://abc123.     â”‚
    â”‚ up.railway.app      â”‚      â”‚ ngrok.io            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                            â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Agregar al final:  â”‚
                 â”‚ /webhook/whatsapp  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ URL COMPLETA â”‚
                    â”‚ PARA TWILIO  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Puntos Clave Visuales

### âœ… URL CORRECTA
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  https://agentewhatsapp-production.up.railway.app          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚            tu proyecto                                     â”‚
â”‚                                                            â”‚
â”‚         /webhook/whatsapp                                  â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚           endpoint                                         â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### âŒ URL INCORRECTA
```
âŒ https://tu-app.railway.app/webhook/whatsapp
   (demasiado genÃ©rico, no es tu URL real)

âŒ https://agentewhatsapp-production.up.railway.app
   (falta /webhook/whatsapp al final)

âŒ https://agentewhatsapp-production.up.railway.app/webhook
   (falta /whatsapp al final)

âŒ http://agentewhatsapp-production.up.railway.app/webhook/whatsapp
   (debe ser https, no http)
```

---

## ğŸ” DÃ³nde Encontrar la URL en Railway

```
RAILWAY DASHBOARD

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ  Dashboard  |  Projects  |  Settings  |  Billing     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  ğŸ“¦ agenteWhatsapp                                     â”‚
â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Deployments    Variables    Settings         â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚                                              â”‚     â”‚
â”‚  â”‚ Settings                                     â”‚     â”‚
â”‚  â”‚                                              â”‚     â”‚
â”‚  â”‚ ğŸŒ Networking                                â”‚     â”‚
â”‚  â”‚                                              â”‚     â”‚
â”‚  â”‚ Domains                                      â”‚     â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚     â”‚
â”‚  â”‚ â”‚ agentewhatsapp-production.          â”‚    â”‚     â”‚
â”‚  â”‚ â”‚ up.railway.app                       â”‚    â”‚     â”‚
â”‚  â”‚ â”‚                          [Copy] [Ã—]  â”‚    â”‚     â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚     â”‚
â”‚  â”‚                                              â”‚     â”‚
â”‚  â”‚ [ + Generate Domain ]                        â”‚     â”‚
â”‚  â”‚                                              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘
         â””â”€â”€â”€ AQUÃ ESTÃ TU URL
```

---

## ğŸ¬ Secuencia de Acciones

```
USUARIO                RAILWAY              TWILIO
   â”‚                      â”‚                    â”‚
   â”‚  1. Deploy          â”‚                    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
   â”‚                     â”‚                    â”‚
   â”‚  2. Generate Domain â”‚                    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
   â”‚                     â”‚                    â”‚
   â”‚  3. Get URL         â”‚                    â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
   â”‚  (agentewhatsapp-   â”‚                    â”‚
   â”‚   production.       â”‚                    â”‚
   â”‚   up.railway.app)   â”‚                    â”‚
   â”‚                     â”‚                    â”‚
   â”‚  4. Configure Webhook                   â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚  (URL/webhook/whatsapp)                  â”‚
   â”‚                     â”‚                    â”‚
   â”‚  5. Send WhatsApp   â”‚                    â”‚
   â”‚     Message         â”‚                    â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                     â”‚                    â”‚
   â”‚                     â”‚  6. POST to        â”‚
   â”‚                     â”‚     Webhook        â”‚
   â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚                     â”‚                    â”‚
   â”‚  7. Process &       â”‚                    â”‚
   â”‚     Respond         â”‚                    â”‚
   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
   â”‚                     â”‚                    â”‚
   â”‚  8. Send Reply      â”‚                    â”‚
   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
   â”‚                     â”‚                    â”‚
```

---

## ğŸ“š Referencias RÃ¡pidas

| Necesitas... | Ve a... |
|--------------|---------|
| Instrucciones detalladas | [WEBHOOK-URL-GUIA.md](WEBHOOK-URL-GUIA.md) |
| GuÃ­a de Railway completa | [RAILWAY-DEPLOYMENT.md](RAILWAY-DEPLOYMENT.md) |
| Troubleshooting | SecciÃ³n de errores comunes en ambos archivos |
| Validar URL | `node test-webhook-url.js` |
| Ver URL en logs | Iniciar servidor y revisar consola |

---

## ğŸ’¡ Tip Visual

**Para recordar:**
```
ğŸ—ï¸  Railway  â†’  ğŸŒ Genera URL  â†’  â• Agregar /webhook/whatsapp  â†’  ğŸ“‹ Copiar a Twilio
```

**FÃ³rmula:**
```
Railway URL + /webhook/whatsapp = Webhook URL para Twilio
```

---

**Â¿AÃºn confundido?** Lee la [GuÃ­a Completa del Webhook](WEBHOOK-URL-GUIA.md) ğŸ“–
